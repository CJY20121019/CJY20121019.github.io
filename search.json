[{"title":"题解：P12605 求和","url":"/2026/02/16/题解：P12605 求和/","content":"## 思路\n把题意转化一下，我们需要计算 $s_1+s_2+\\cdots+s_n$ 和 $t_1+t_2+\\cdots+t_n$ 的表达式。\n\n首先计算前缀和的总和：\n$$S=\\sum_{k=1}^ns_k=\\sum_{k=1}^n\\sum_{i=1}^ka_i=\\sum_{i=1}^na_i \\cdot (n-i+1)$$\n这是因为每个 $a_i$ 在 $s_i,s_{i+1},\\cdots,s_n$ 中出现了 $(n-i+1)$ 次。\n\n我们用同样的方法计算后缀和的总和：\n$$T=\\sum_{k=1}^nt_k=\\sum_{k=1}^n\\sum_{i=k}^na_i=\\sum_{i=1}^na_i \\cdot i$$\n这是因为每个 $a_i$ 在 $t_1,t_2,\\cdots,t_i$ 中出现了 $i$ 次。\n\n因此，等式 $S=T$ 可表示为：\n$$\\begin{aligned}\n\\sum_{i=1}^na_i \\cdot (n-i+1)&=\\sum_{i=1}^na_i \\cdot i\\\\\n\\sum_{i=1}^na_i \\cdot (n-i+1)-\\sum_{i=1}^na_i \\cdot i&=0\\\\\n\\sum_{i=1}^na_i \\cdot (n-i+1-i)&=0\\\\\n\\sum_{i=1}^na_i \\cdot (n-2i+1)&=0\n\\end{aligned}\n$$\n记 $c_i=n-2i+1$，则条件为：\n$$\\sum_{i=1}^na_i \\cdot c_i=0$$\n我们设初始偏差为 $D$，计算初始的 $D=\\sum\\limits_{i=1}^na_i \\cdot c_i$\n我们每次可以选择 $i$ 和 $j$，$D$ 的变化为 $c_i-c_j=2(j-i)$。因此，每次操作可以调整 $D$ 的值为 $\\pm2(j-i)$。为了最小化操作次数，应尽可能选择最大的 $|j-i|$，即 $i=1,j=n$，此时 $|\\Delta|=2(n-1)$。\n\n* 如果 $D$ 是奇数，显然无法通过偶数次调整得到 $0$，直接返回 $-1$。\n* 如果 $D$ 是偶数，最小操作次数为 $\\lceil\\frac{|D|}{2(n-1)}\\rceil$。\n## Code\n```cpp\n#include<bits/stdc++.h>\n#define ll long long\nusing namespace std;\nconst int maxn=1e6+5;\nll n,a[maxn],d;\nint main(){\n\tcin>>n;\n\tfor(ll i=1;i<=n;i++) cin>>a[i];\n\tif(n==1){cout<<0;return 0;}\n\tfor(ll i=1;i<=n;i++){\n\t\tll c=n-i*2+1;\n\t\td+=a[i]*c;\n\t}\n\tif(d%2) cout<<-1;\n\telse cout<<(abs(d)+2*(n-1)-1)/(2*(n-1));\n}\n```\n注意：\n* 要开 `long long`。\n* 要特判 $n=1$ 的情况，因为如果这样的话 $n-1=0$，会导致除零错误，会 `RE`。\n* 如果使用 `ceil` 向上取整的话会出现浮点误差，所以推荐使用代码中的写法进行向上取整。","tags":["贪心","前缀和"],"categories":["题解"]},{"title":"题解：P1431 找出伪币","url":"/2026/02/16/题解：P1431 找出伪币/","content":"## 思路\n每次 $p$ 就只有两种状态：\n* 当 $p \\ne 0$ 时。每次称重有 $3$ 种可能结果（左重、右重、平衡），可产生 $\\log_3 3=1$ 个三进制位的信息量，区分 $n$ 个不同情况需要 $\\lceil \\log_3 n \\rceil$ 次称重。所以最少称量次数 $m$ 满足 $3^m \\ge n$，即 $m = \\lceil \\log_3 n \\rceil$。\n* 当 $p=0$ 时。这个时候我们不仅需要定位伪币，还需确定其轻重，每个硬币有 $2$ 种可能性（可能轻或重），总可能性为 $2n$ 种，最少需要区分 $2n+3$ 种情况。证明的话可以去看其他题解，这里不再赘述。所以最少称量次数 $m$ 满足 $3^m \\ge 2n + 3$，即 $m=\\lceil \\log_3 (2n+3) \\rceil$。\n\n然而，这道题目的关键点在于高精度，普通高精被卡，只能用压位高精……我写的是 $18$ 位压位存储，时间复杂度 $\\Theta(\\frac{Tk^2}{18^2})=\\Theta(\\frac{Tk^2}{324})$。\n## Code\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst long long BASE=1e18;//定义大数的基数为 1e18（每位存储 18 位十进制数）\nconst int BASE_DIGITS=18;\nvector<long long>sto(string s){//字符串转大数（按 18 位分割存储）\n\tvector<long long>res;\n\tfor(int i=s.size();i>0;i-=BASE_DIGITS){//从字符串末尾开始，每次处理 18 位\n\t\tint start=max(0,i-BASE_DIGITS);//计算当前段的起始位置\n\t\tstring part=s.substr(start,i-start);//截取 18 位字符串\n\t\tres.push_back(stoll(part));//转换为 long long 并存入 vector\n\t}\n\treturn res;\n}\nvector<long long>mul(vector<long long>a,int b){//大数乘法\n\tvector<long long>res;\n\tlong long c=0;//进位\n\tfor(long long x:a){//逐位相乘\n\t\tlong long p=x*b+c;//当前位乘积+进位\n\t\tres.push_back(p%BASE),c=p/BASE;//取模得到当前位并计算新的进位\n\t}\n\twhile(c) res.push_back(c%BASE),c/=BASE;//处理剩余进位\n\treturn res;\n}\nvector<long long>add(vector<long long> a,vector<long long> b){//大数加法\n\tvector<long long>res;\n\tlong long c=0;//进位\n\tfor(int i=0;i<max(a.size(),b.size())||c;i++){//逐位相加（处理不等长情况）\n\t\tlong long sum=c;\n\t\tif(i<a.size()) sum+=a[i];\n\t\tif(i<b.size()) sum+=b[i];\n\t\tres.push_back(sum%BASE),c=sum/BASE;//取模得到当前位并计算新的进位\n\t}\n\treturn res;\n}\nbool cmp(vector<long long>a,vector<long long>b){//大数比较\n\tif(a.size()!=b.size()) return a.size()>b.size();//先比较位数\n\tfor(int i=a.size()-1;i>=0;i--){//从高位到低位逐位比较\n\t\tif(a[i]!=b[i]) return a[i]>b[i];\n\t}\n\treturn true;\n}\nint solve(string s,bool f){\n\tvector<long long>t=sto(s);\n\tif(f){//如果需要特殊计算\n\t\tt=mul(t,2);\n\t\tvector<long long>k={3};\n\t\tt=add(t,k);\n\t}\n\tvector<long long>a={1};\n\tint m=0;//幂次计数\n\twhile(!cmp(a,t)) a=mul(a,3),m++;//不断乘 3 直到大于等于目标值\n\treturn m;\n}\nint main(){\n\tios::sync_with_stdio(0),cin.tie(0);\n\tint T;cin>>T;\n\twhile(T--){\n\t\tint k,p;string n;cin>>k>>p>>n;\n\t\tbool f=(p==0);//特判\n\t\tcout<<solve(n,f)<<'\\n';\n\t}\n}\n```\n有问题请指出！","tags":["数学","高精度"],"categories":["题解"]},{"title":"题解：P6842 [BalkanOI 2009] Strip","url":"/2026/02/16/题解：P6842 [BalkanOI 2009] Strip/","content":"感觉其他题解有点难懂，这里发一篇通俗的。\n## 思路\n我们维护两个变量 $l,r$ 分别表示当前条带的左右端点，再维护一个数组 $t$ 表示**翻折（即“对称轴”）的实际位置**。\n\n因为往右边翻可以保证 $l \\ge 0,r \\ge 0$，所以我们**统一往右边翻**。\n\n我们考虑一个问题：对于对称轴 $s$ 折叠后，原来位置 $x$ 的点现在在哪里？\n* 如果 $x \\ge s$：还在原来的位置。\n* 如果 $x<s$：被翻到右边，新位置为 $2s-x$。\n\n我们设每次读进来的“对称轴”为 $a$。但由于经过了翻折，$a$ 对应的是原条带的下标，而我们要的是当前的实际下标。所以我们要求出，经过前 $i-1$ 次折叠后，原始位置 $a$ 在当前条带中的实际位置是多少？\n\n设 $f(x)$ 表示原始位置 $x$ 经过所有折叠后的实际位置。对于第 $j$ 次折叠在位置 $t_j$：\n* 如果 $f(x) \\ge t_j$：保持不变。\n* 如果 $f(x)<t_j$：那么 $f(x)=2 \\times t_j-f(x)$。\n\n由此我们可以得到 $a$ 每次操作得到的实际位置是 $a=\\max(a,2 \\times t_j-a)$，需要进行 $i-1$ 次翻折操作才能求出 $a$ 的实际位置。\n\n我们知道了“对称轴”的位置，就可以求出 $l,r$ 的值啦！$r$ 的位置变成了 $r$ 和 $l$ 的对称点的最大值（因为翻折后 $r$ 有可能会超过原来右端点的位置，也有可能不超过，所以取最大值），$l$ 的位置变成了 $a$ 的位置，我们根据上面的公式可得出 $r=\\max(r,2a-l),l=a$。\n\n**注意不能交换操作顺序，必须先更新 $r$ 再更新 $l$，因为 $r$ 的计算需要旧的 $l$ 值。否则只有 $28$ 分……。**\n\n由于题目中的长度定义为**两端点之间的距离**，而我们的 $l,r$ 是条带的左右端点位置，因此输出 $r-l$ 即可得到正确的条带长度，不要输出 $r-l+1$。\n\n代码和楼上楼下差不多，就不贴了。","tags":["数学","模拟"],"categories":["题解"]},{"title":"CSP-J/S 2025 游记","url":"/2026/02/16/CSP-JS 2025 游记/","content":"## 前言\n[前景摘要](https://www.luogu.com.cn/article/dc2jdedt)。\n\n这是我第一次 CSP 进复赛，必须记录一下！\n## 初赛\n### Day#0\n上初一了，晚上写了会儿作业，没时间开电脑。\n### Day#1\n#### 赛前\n早上 4:30 就行了，开电脑，复习。\n\n抽了一下运势，还是 `中吉`。\n\n早上出发去镇海蛟川书院，那里人好多啊，感觉再晚一点就来不及了。\n#### CSP-J\n拿到试卷赶紧翻了一下，发现题目还可以，长输了一口气。\n\n然后就开始疯狂地写试卷，刷刷刷奋笔疾书，废了好几页草稿纸，有一题我直接模拟 $O(n!)$，此间一切顺利。\n#### 中午\n出考场后，我发现我被第一题坑了，题目说的是**无符号**……\n\n估分，发现各个平台估出来的分都不一样（差距还挺大），就躺平了。在肯德基吃了一个汉堡，背了一会 whk，就又出发了。\n#### CSP-S\n已经做足了心理准备，该做的做，该猜的猜，胡乱写完了。\n\n当我看到代码中有一个 `You have no egg.` 的时候，我差点喷出来。\n#### 赛后\nJ 组估分 $81 \\pm 5$，S 组估分 $60 \\pm 10$。结果最后 J 组得了 $79$，S 组得了 $66$，都进了复赛。唯一遗憾的是，S 组一等线为 $66.5$，就差半分就可以一等了！/kel\n## 复赛\n### Day#0\n下午提早从学校出来，去赶六点钟的动车，可惜是无座票，只能一边站着一边背道法了（腿真的好累啊 awa）。到达杭州东后，上出租车去酒店，我爸和司机聊了一路。来到酒店，坐了一会儿 whk 作业，复习了一会 CSP 就睡了。\n### Day#1\n#### 赛前\n一大早起来吃早餐，然后就出发了，一会儿就抵达杭州师范大学下沙校区了。\n#### CSP-J\n开题！发现题目好简单呀。\n\nT1&T2 直接秒了。\n\nT3 没有把握，只会写一个前缀异或和+错误贪心思路，感觉肯定会 WA。\n\nT4 只会写暴力，但是在赛场上忘记 `next_permutation` 怎么用了，就临时写了个 dfs，顺便写了个对拍，应该没问题。\n#### 中午\n我爸去保安那要了一个二维码，进了食堂，感觉饭菜还可以。但是我没时间估分了。\n#### CSP-S\n下午 T1 想出了贪心思路但发现思路假了，直接崩溃，然后调暴力，感觉只能拿 $25$ 分。\n\nT2 感觉有点复杂，懒得写（其实是因为 T1 已经调了 2h 了），直接水了一个乱搞代码，预估分数 $0$。\n\nT3 看不懂在干什么，直接总司令，预估分数 $0$。\n\nT4 看懂了但是不知道怎么写，就水了个特殊性质。\n#### 赛后\nJ 组估分 $100+100+30+40=270$，但实际分数为 $100+100+20+40=260$，真的不知道 T3 为什么会挂了 $10$ 分；S 组估分 $25+0+0+0=25$，但实际分数为 $35+0+0+4=39$，有点神奇。没能拿到 NOIP 资格……\n## 后记\n这次不知道能不能拿到一等+五级钩（大概率没了），明年再战！CSP-2026 RP++！","tags":["2025"],"categories":["生活·游记"]},{"title":"必看","url":"/2026/02/16/必看/","content":"这里是 [\\_\\_CJY__](https://www.luogu.com.cn/user/1086453) 的个人博客，在这里你可以看到：\n* 精美的学习笔记\n* 逻辑清晰的题解${}^{\\tt 1}$\n* 惊心动魄的游记\n\n${}^{\\tt 1}$：特别的，这里只记录在[洛谷](https://www.luogu.com.cn/)上深受好评的**优质**题解，如果你想看到我的所有文章，请[截这里](https://www.luogu.com.cn/user/1086453/article)！\n\n**另外，这是[我的私信](https://www.luogu.com.cn/chat?uid=1086453)，欢迎交流、勘误，也希望你们在我的洛谷专栏上能多多点赞！**\n\n***祝你看得开心！***","categories":["重要杂文"]},{"title":"题解：P14954 520","url":"/2026/02/15/题解：P14954 520/","content":"\n感觉其他题解讲的都不太清楚，我来讲讲，可能有些重复，请见谅！\n## 思路\n1. 首先先把已有的 $520$ 找出来，并将它们标记为空。\n2. 再把缺一个数字的（即 $52,20,50$）算上。\n3. 按照“优先使用当前最不稀缺的插入字符”的贪心策略用单个字符加两个插入字符形成 $520$。\n4. 剩下的插入字符直接组成完整的 $520$，加上。\n## Code\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nint T,n,a,b,c,res,s1,s2,s3;\nint main(){\n\tcin>>T;\n\twhile(T--){\n\t\tcin>>n>>a>>b>>c,res=s1=s2=s3=0;\n\t\tstring s;cin>>s;\n\t\tfor(int i=0;i<n-2;i++){//第一步\n\t\t\tif(s.substr(i,3)==\"520\") res++,s[i]=s[i+1]=s[i+2]=' ';\n\t\t}\n\t\tfor(int i=0;i<n-1;i++){//第二步\n\t\t\tif(s.substr(i,2)==\"52\"&&c) res++,c--,s[i]=s[i+1]=' ';\n\t\t\telse if(s.substr(i,2)==\"20\"&&a) res++,a--,s[i]=s[i+1]=' ';\n\t\t\telse if(s.substr(i,2)==\"50\"&&b) res++,b--,s[i]=s[i+1]=' ';\n\t\t}\n\t\tfor(int i=0;i<n;i++){//统计三种数字的个数\n\t\t\tif(s[i]=='5') s1++;\n\t\t\telse if(s[i]=='2') s2++;\n\t\t\telse if(s[i]=='0') s3++;//注意这里不能用 else，因为 s[i] 有可能为空格\n\t\t}\n\t\twhile(s1||s2||s3){//第三步\n\t\t\tif(a>=c&&b>=c&&s3&&a&&b) res++,s3--,a--,b--;//如果 a 和 b 都 >= c，且有 0 可用，则消耗 a 和 b\n\t\t\telse if(a>=b&&c>=b&&s2&&a&&c) res++,s2--,a--,c--;//同上\n\t\t\telse if(b>=a&&c>=a&&s1&&b&&c) res++,s1--,b--,c--;//同上\n\t\t\telse break;\n\t\t}\n\t\tres+=min({a,b,c}),cout<<res<<'\\n';//第四步\n\t}\n}\n```","tags":["贪心"],"categories":["题解"]}]